<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¯Ø±Ø¯Ø´Ø© P2P Ø¨Ø±Ùˆ</title>
  <style>
    body { background:#2c2f33; color:#fff; font-family:sans-serif; text-align:center; padding:20px; }
    textarea, input, button { width:90%; padding:10px; margin:5px; border:none; border-radius:5px; }
    textarea, input { background:#23272a; color:white; }
    button { background:#7289da; color:white; cursor:pointer; }
    #chat { background:#1e2124; padding:10px; height:200px; overflow-y:auto; border-radius:5px; text-align:left; }
  </style>
</head>
<body>
  <h2>Ø´Ø§Øª P2P Ø¨Ø¯ÙˆÙ† Ø³ÙŠØ±ÙØ± ğŸ”—</h2>
  <textarea id="code" placeholder="ğŸ“‹ Ø¶Ø¹ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ø³Ø®Ù‡ Ù„ØµØ¯ÙŠÙ‚Ùƒ"></textarea><br>
  <button onclick="connect()">ğŸ”Œ Ø§ØªØµØ§Ù„</button>
  <button onclick="create()">âš¡ Ø¥Ù†Ø´Ø§Ø¡</button>
  <div id="chat"></div>
  <input id="msg" placeholder="âœï¸ Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...">
  <button onclick="send()">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„</button>

  <script>
    const words = ["red", "blue", "green", "apple", "banana", "cloud", "sky", "light", "dark", "fast", "slow", "cat", "dog"];

    function generateCode() {
      let code = Array.from({length: 3}, () => words[Math.floor(Math.random() * words.length)]).join("-");
      return code;
    }

    let p = new RTCPeerConnection(), ch = p.createDataChannel("x");

    ch.onmessage = e => chat.innerHTML += `<p>${e.data}</p>`;
    p.ondatachannel = e => e.channel.onmessage = ch.onmessage;

    async function create() {
      let offer = await p.createOffer();
      await p.setLocalDescription(offer);
      setTimeout(() => {
        let text = JSON.stringify(p.localDescription);
        let customCode = generateCode();
        navigator.clipboard.writeText(text);
        alert(`âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø® ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§!\nğŸ” ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©: ${customCode}\nØ£Ø±Ø³Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù„ØµØ¯ÙŠÙ‚Ùƒ.`);
      }, 500);
    }

    async function connect() {
      let remote = JSON.parse(document.getElementById("code").value);
      await p.setRemoteDescription(remote);
    }

    function send() {
      if (ch.readyState === "open") {
        let msg = document.getElementById("msg").value;
        ch.send(msg);
        chat.innerHTML += `<p><b>Ø£Ù†Ø§:</b> ${msg}</p>`;
        document.getElementById("msg").value = "";
      } else {
        alert("ğŸ’¡ Ø§Ù„Ø§ØªØµØ§Ù„ ØºÙŠØ± Ø¬Ø§Ù‡Ø² Ø¨Ø¹Ø¯!");
      }
    }
  </script>
</body>
</html>
